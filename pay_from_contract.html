<html>
  <head>
    <title>Payment Coin</title>
  </head>
  <body>
    <button onclick="check()">check</button>
    
    
    <script type="text/javascript" src="https://unpkg.com/web3@latest/dist/web3.min.js"></script>
    <script type="text/javascript" src="https://unpkg.com/web3modal@latest/dist/index.js"></script>
    <script type="text/javascript" src="https://unpkg.com/@walletconnect/web3-provider@latest/dist/umd/index.min.js"></script>
    
    
    <script>
      const Web3Modal = window.Web3Modal.default;
      const WalletConnectProvider = window.WalletConnectProvider.default;                                    
          
    
      var web3Modal;
      var web3;
    
      var account='0x0e148626B2c46968cfCD5b8cd07eb7E648dAeB91';                       
      var contract_address;                        
      var contract_abi;    
      var contract;     
    
      window.addEventListener('load', async function() {                       
        await init();                                                  
      });  
      
      async function init(){
        web3 = new Web3(new Web3.providers.HttpProvider("https://data-seed-prebsc-1-s1.binance.org:8545/"));   
        contract_address = web3.utils.toChecksumAddress("0x0a320c2879B8c786aD0a26D3e8927Cd914301B40");
        contract_abi = JSON.parse('[{"inputs":[{"internalType":"address","name":"_tokenContract","type":"address"},{"internalType":"address","name":"_machine","type":"address"},{"internalType":"uint256","name":"_payment_per_unit","type":"uint256"}],"stateMutability":"nonpayable","type":"constructor"},{"inputs":[],"name":"admin","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"machine","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"payment_counter","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"payment_counter_check","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"payment_per_unit","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"","type":"address"}],"name":"transfer_balances","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"transfer_payment_counter","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"to","type":"address"},{"internalType":"uint256","name":"value","type":"uint256"}],"name":"transfer_save","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"to","type":"address"}],"name":"withdrawToken","outputs":[],"stateMutability":"nonpayable","type":"function"},{"stateMutability":"payable","type":"receive"}]');            
        contract = await new web3.eth.Contract(contract_abi,contract_address);        
      }  
      
      async function check(){      
        const myData = await contract.methods.transfer_payment_counter().encodeABI();  
        
        var nonce = await web3.eth.getTransactionCount(account);
        
        var transactionObject = {
          nonce:    nonce,
        	from: account,
          to:       contract,
          value:    0,
          gasLimit: '2100',
          gasPrice: web3.utils.toWei('3', 'gwei'),
          data: myData  
        };
                                 
        var signed_transaction = await web3.eth.accounts.signTransaction(transactionObject, '276bb9b561a9738fbca959563b1c469b91ab11a27b5fce760a98d67d0d32d359');
        
        console.log(signed_transaction);
      }    
      
      
      
      Number.prototype.formatMoney = function(decPlaces, thouSeparator, decSeparator) {
              var n = this,
                  decPlaces = isNaN(decPlaces = Math.abs(decPlaces)) ? 2 : decPlaces,
                  decSeparator = decSeparator == undefined ? "." : decSeparator,
                  thouSeparator = thouSeparator == undefined ? "," : thouSeparator,
                  sign = n < 0 ? "-" : "",
                  i = parseInt(n = Math.abs(+n || 0).toFixed(decPlaces)) + "",
                  j = (j = i.length) > 3 ? j % 3 : 0;
              return sign + (j ? i.substr(0, j) + thouSeparator : "") + i.substr(j).replace(/(\d{3})(?=\d)/g, "$1" + thouSeparator) + (decPlaces ? decSeparator + Math.abs(n - i).toFixed(decPlaces).slice(2) : "");
      }; 
    </script>
  
  </body>
</html>
